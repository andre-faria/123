<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8" />
<title>Ju's Valentine's Quiz üíê</title>

<style>
  body {
    margin: 0;
    height: 100vh;
    font-family: "Segoe UI", sans-serif;

    background-image: url("https://images.unsplash.com/photo-1557929036-44a5d490d527?auto=format&fit=crop&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&ixlib=rb-4.1.0&q=80&w=3024");
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;

    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  /* Floating hearts */
  #heartsContainer {
    position: fixed;
    inset: 0;
    pointer-events: none;
    overflow: hidden;
    z-index: -1;
  }
  .heart {
    position: absolute;
    color: #ff6fa8;
    font-size: 20px;
    opacity: 0.8;
    animation: floatUp 6s linear forwards;
  }
  @keyframes floatUp {
    0% { transform: translateY(0) scale(1); opacity: 0.8; }
    100% { transform: translateY(-120vh) scale(1.6); opacity: 0; }
  }

  /* Title */
  .quiz-title {
    text-align: center;
    margin-bottom: 20px;
  }
  .quiz-title h1 {
    font-size: 42px;
    color: #ff4d6d;
    text-shadow: 2px 2px 4px #fff;
    margin: 0;
  }
  .quiz-title p {
    font-size: 18px;
    color: #fff;
    text-shadow: 1px 1px 2px #000;
    margin: 5px 0 0 0;
  }

  /* Card */
  .card {
    background: rgba(255, 255, 255, 0.97);
    width: 92%;
    max-width: 780px;
    min-height: 560px;
    padding: 48px 40px;
    border-radius: 28px;
    text-align: center;
    box-shadow: 0 24px 48px rgba(0,0,0,0.3);
    display: flex;
    flex-direction: column;
    justify-content: center;
    position: relative;
    overflow: hidden;
  }

  h2 { margin-top: 0; font-size: 28px; }
  h3 { font-size: 22px; margin-top: 24px; }
  .counter { font-weight: bold; font-size: 18px; margin-bottom: 18px; }
  .feedback { font-size: 20px; margin: 18px 0; min-height: 24px; }

  /* Buttons */
  button {
    margin: 10px;
    padding: 10px 18px;
    border-radius: 24px;
    border: none;
    font-size: 16px;
    cursor: pointer;
    background: #ff4d6d;
    color: white;
    transition: background 0.2s;
  }
  button:hover { background: #ff1e4d; }

  .decision-wrap {
    position: relative;
    height: 120px;
    margin-top: 14px;
  }

  #yesBtn { z-index: 1; }

  #noBtn {
    position: absolute;
    left: 50%; top: 50%;
    transform: translate(-50%, -50%);
    padding: 6px 10px;
    font-size: 13px;
    min-width: 64px;
    height: 30px;
    z-index: 2;
  }

  /* Progress bar */
  .progress-wrapper {
    width: 100%;
    height: 12px;
    background: #ffd6e5;
    border-radius: 10px;
    margin-bottom: 20px;
    overflow: hidden;
  }
  .progress-bar {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, #ff4d6d, #ff92ae);
    transition: width 0.4s ease;
  }

  canvas { position: fixed; inset: 0; pointer-events: none; }
</style>
</head>

<body>

<div id="heartsContainer"></div>

<div class="quiz-title">
  <h1>üíò O quiz mais importante da sua vida, menina Juliana! üíê</h1>
  <p>Ser√° que consegues? Vamos descobrir!!</p>
</div>

<div class="card" id="app"></div>
<canvas id="confetti"></canvas>

<script>
/* ========= CONFIG ========= */
const CHAOS = true;      // true = teleport, false = dodge
const DELAY = 2000;      // time before next question
const step   = 200;      
const radius = 110;
/* ========================== */

const questions = [
  { q: "Qual foi o tema do Escape Room do nosso primeiro date?", a: ["Orfanato", "Alice", "Escobar", "Pris√£o"], c: 0 },
  { q: "Restaurante onde jantamos no nosso primeiro Valentine's?", a: ["Flow", "Portarossa", "Mistu", "H3"], c: 2 },
  { q: "Concerto que fomos ver no dia seguinte ao nosso primeiro anivers√°rio?", a: ["Kendrick & SZA", "The Weekend", "Posty", "Taylor"], c: 2 },
  { q: "Quem √© a coisinha mais linda e fofa?", a: ["Eu", "Tu", "Eu, obvio", "Obviamente tu"], c: 3 }
];

let index = 0, correct = 0, wrong = 0;
const app = document.getElementById("app");

/* START SCREEN */
function startScreen() {
  app.innerHTML = `
    <h2>üíò Bem-vinda ao Valentine's Quiz üíò</h2>
    <p>Est√°s pronta?</p>
    <button onclick="startQuiz()">Come√ßar ‚ù§Ô∏è</button>
  `;
}

function startQuiz() {
  index = 0;
  correct = 0;
  wrong = 0;
  renderQuestion();
}

/* QUESTION RENDERING */
function renderQuestion(feedback = "") {
  const q = questions[index];
  app.innerHTML = `
    <div class="progress-wrapper">
      <div class="progress-bar" id="progressBar"></div>
    </div>
    <div class="counter">${correct}/${questions.length} corretas</div>
    <h2>${q.q}</h2>
    ${q.a.map((ans,i)=>`<button onclick="answer(${i})">${ans}</button>`).join("")}
    <div class="feedback">${feedback}</div>
  `;

  const progress = Math.floor((index / questions.length) * 100);
  document.getElementById("progressBar").style.width = progress + "%";
}

function answer(i) {
  const isCorrect = i === questions[index].c;
  if (isCorrect) correct++; else wrong++;

  renderQuestion(isCorrect ? "‚úÖ Corret√≠ssimo!" : "‚ùå FOCA-TE MENINA! üò§");

  setTimeout(() => {
    if (wrong >= 2) failScreen();
    else {
      index++;
      if (index < questions.length) renderQuestion();
      else resultScreen();
    }
  }, DELAY);
}

/* FAIL */
function failScreen() {
  app.innerHTML = `
    <h2>üòî Oopsiee...</h2>
    <p>Acabaste de perder um monte de beijos üíãüíã</p>
    <p>Tenta novamente...</p>
    <button onclick="startQuiz()">Come√ßar de novo</button>
  `;
}

/* RESULT SCREEN */
function resultScreen() {
  if (correct >= 3){
    app.innerHTML = `
      <h2>üéâ HIHIHIHIH GANHOU!!!!!</h2>
      <p>${correct}/4 corretas üíñ</p>
      <h3>Will you be my Valentine?</h3>

      <div class="decision-wrap" id="decisionWrap">
        <button id="yesBtn" onclick="yes()">Yes üíò</button>
        <button id="noBtn" type="button">No üíî</button>
      </div>
    `;

    const wrap = document.getElementById("decisionWrap");
    const noBtn = document.getElementById("noBtn");

    if (CHAOS) {
      function teleport() {
        const wrapRect = wrap.getBoundingClientRect();
        const btnRect  = noBtn.getBoundingClientRect();

        const x = Math.random() * (wrapRect.width  - btnRect.width);
        const y = Math.random() * (wrapRect.height - btnRect.height);

        noBtn.style.left = x + "px";
        noBtn.style.top  = y + "px";
        noBtn.style.transform = "translate(0, 0)";
      }

      wrap.addEventListener("mousemove", teleport);
      noBtn.addEventListener("mouseenter", teleport);
      noBtn.addEventListener("mousemove", teleport);
      noBtn.addEventListener("touchstart", (e) => { e.preventDefault(); teleport(); }, { passive: false });

    } else {
      function dodge(ev) {
        const wrapRect = wrap.getBoundingClientRect();
        const btnRect  = noBtn.getBoundingClientRect();
        const px = ev.clientX ?? (ev.touches && ev.touches[0]?.clientX);
        const py = ev.clientY ?? (ev.touches && ev.touches[0]?.clientY);
        if (!px) return;

        const cx = btnRect.left + btnRect.width/2;
        const cy = btnRect.top  + btnRect.height/2;
        const dx = cx - px;
        const dy = cy - py;
        const dist = Math.hypot(dx, dy);

        if (dist > radius) return;

        const nx = dx / (dist || 1);
        const ny = dy / (dist || 1);

        let targetCx = cx + nx * step;
        let targetCy = cy + ny * step;

        const minCx = wrapRect.left + btnRect.width/2;
        const maxCx = wrapRect.right - btnRect.width/2;
        const minCy = wrapRect.top  + btnRect.height/2;
        const maxCy = wrapRect.bottom - btnRect.height/2;

        targetCx = Math.min(Math.max(targetCx, minCx), maxCx);
        targetCy = Math.min(Math.max(targetCy, minCy), maxCy);

        noBtn.style.left = `${targetCx - wrapRect.left}px`;
        noBtn.style.top  = `${targetCy - wrapRect.top}px`;
        noBtn.style.transform = "translate(-50%, -50%)";
      }

      wrap.addEventListener("mousemove", dodge);
      noBtn.addEventListener("mouseenter", dodge);
      noBtn.addEventListener("mousemove", dodge);
      noBtn.addEventListener("touchstart", (e) => { e.preventDefault(); dodge(e); }, { passive: false });
    }

  } else failScreen();
}

/* YES */
function yes(){
  app.innerHTML = `<h2>üíñ SHE SAID YESSS! (QUE REM√âDIO N√ÉO √â) üíñ</h2><p>SE PREPAREEEE üòç</p>`;
  startConfetti();
}

/* CONFETTI */
const canvas = document.getElementById("confetti");
const ctx = canvas.getContext("2d");

function sizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
sizeCanvas();
window.addEventListener("resize", sizeCanvas);

let pieces = [];
function startConfetti(){
  pieces.length = 0;
  for(let i = 0; i < 300; i++) pieces.push({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    r: Math.random() * 6 + 4,
    c: `hsl(${Math.random()*360},100%,50%)`,
    s: Math.random() * 4 + 2
  });
  requestAnimationFrame(drawConfetti);
}

function drawConfetti(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for(const p of pieces){
    ctx.fillStyle = p.c;
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
    ctx.fill();
    p.y += p.s;
    if(p.y > canvas.height) p.y = -10;
  }
  requestAnimationFrame(drawConfetti);
}

/* HEARTS */
const heartsContainer = document.getElementById("heartsContainer");

function spawnHeart() {
  const heart = document.createElement("div");
  heart.className = "heart";
  heart.textContent = "üíó";
  heart.style.left = Math.random() * 100 + "vw";
  heart.style.fontSize = (Math.random() * 20 + 15) + "px";
  heartsContainer.appendChild(heart);
  setTimeout(() => heart.remove(), 6000);
}
setInterval(spawnHeart, 400);

/* START QUIZ */
startScreen();
</script>

</body>
</html>
